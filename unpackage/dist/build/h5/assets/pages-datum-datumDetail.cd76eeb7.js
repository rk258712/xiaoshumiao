import{B as s,Q as t,D as e,j as i,s as o,_ as l,a0 as a,y as n,o as c,c as d,w as h,i as u,d as r,f as m,g as f,a1 as p}from"./index-dc4240aa.js";import{_ as g}from"./_plugin-vue_export-helper.1b428a4d.js";const w=g({data:()=>({datum:null,webviewStyles:{height:"0"},src:null,caches:null,findItem:null,downloadIng:!1}),onReady(){if(null==this.findItem){let e=s(),i=e.statusBarHeight+e.windowTop,o=s().windowHeight-i;t().select("#bottom").fields({size:!0,scrollOffset:!0},(s=>{let t=s.height,e=o-t;this.webviewStyles.height=e+"px"})).exec()}setTimeout((()=>{e({title:"资料详情"})}),2e3)},onLoad(s){let t=JSON.parse(decodeURIComponent(s.data));console.log(t),this.datum=t,this.caches=i("datum-list")||[],this.findItem=this.caches.find((s=>s.id===this.datum.id)),console.log("------findItem"),console.log(this.findItem),this.src=this.$request.imageBaseUrl+this.datum.pdfUrl,console.log(this.src)},methods:{save(){const s=this.caches.findIndex((s=>s.id==this.datum.id));console.log(s),console.log("======"),-1!==s?(this.caches.splice(s,1),this.caches.unshift(this.datum)):this.caches.unshift(this.datum),o("datum-list",this.caches)},downloadFile(){let s=this;l({url:this.src,success:t=>{200===t.statusCode?a({tempFilePath:t.tempFilePath,success:function(t){s.datum.filePath=t.savedFilePath,s.save(),n({title:"下载成功",duration:2e3,icon:"none"})}}):n({title:t.msg,duration:2e3,icon:"none"})}}).onProgressUpdate((s=>{console.log("下载进度"+s.progress),console.log("已经下载的数据长度"+s.totalBytesWritten),console.log("预期需要下载的数据总长度"+s.totalBytesExpectedToWrite)}))}}},[["render",function(s,t,e,i,o,l){const a=p,n=u;return c(),d(n,{class:"page"},{default:h((()=>[null!=o.src?(c(),d(a,{key:0,style:{position:"absolute",display:"block",border:"0px",top:"44px",left:"0px",width:"414px"},src:o.src,"webview-styles":o.webviewStyles},null,8,["src","webview-styles"])):r("",!0),null==o.findItem?(c(),d(n,{key:1,id:"bottom",class:"commit-bg"},{default:h((()=>[m(n,{class:"commit",onClick:l.downloadFile},{default:h((()=>[f("下载资料")])),_:1},8,["onClick"])])),_:1})):r("",!0)])),_:1})}],["__scopeId","data-v-fce64a91"]]);export{w as default};
